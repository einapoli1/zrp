{{define "open-ecos-report"}}
<div class="card">
  <div class="flex justify-between items-center mb-4">
    <div class="flex items-center gap-3">
      <button class="btn btn-secondary" hx-get="/reports" hx-target="#main-content" hx-swap="innerHTML">‚Üê Back</button>
      <h2 class="text-lg font-semibold">Open ECOs by Priority</h2>
    </div>
    <a href="/api/v1/reports/open-ecos?format=csv" target="_blank" class="btn btn-secondary">üì• Export CSV</a>
  </div>

  {{if .ReportData}}
  <div class="overflow-x-auto">
    <table class="w-full text-sm">
      <thead>
        <tr class="border-b text-left text-gray-500">
          <th class="pb-2">ID</th>
          <th class="pb-2">Title</th>
          <th class="pb-2">Status</th>
          <th class="pb-2">Priority</th>
          <th class="pb-2">Created By</th>
          <th class="pb-2 text-right">Age (Days)</th>
        </tr>
      </thead>
      <tbody>
        {{range .ReportData}}
        <tr class="border-b border-gray-100 table-row" onclick="window.location='/ecos/{{.ID}}'">
          <td class="py-2 font-mono text-blue-600">{{.ID}}</td>
          <td class="py-2">{{.Title}}</td>
          <td class="py-2">
            {{if eq .Status "draft"}}
              <span class="badge badge-draft">Draft</span>
            {{else if eq .Status "review"}}
              <span class="badge badge-review">Review</span>
            {{else}}
              <span class="badge badge-secondary">{{.Status}}</span>
            {{end}}
          </td>
          <td class="py-2">
            {{if eq .Priority "critical"}}
              <span class="badge badge-critical">Critical</span>
            {{else if eq .Priority "high"}}
              <span class="badge badge-high">High</span>
            {{else if eq .Priority "normal"}}
              <span class="badge badge-normal">Normal</span>
            {{else if eq .Priority "low"}}
              <span class="badge badge-low">Low</span>
            {{else}}
              <span class="badge badge-secondary">{{.Priority}}</span>
            {{end}}
          </td>
          <td class="py-2">{{.CreatedBy}}</td>
          <td class="py-2 text-right">{{.AgeDays}}</td>
        </tr>
        {{end}}
      </tbody>
    </table>
  </div>
  {{else}}
  {{template "empty-state" (dict "Message" "No open ECOs" "ActionURL" "/ecos/new" "ActionLabel" "Create ECO")}}
  {{end}}
</div>
{{end}}