{{define "content"}}
<div class="mb-4">
  <a href="/ecos" class="text-blue-600 hover:underline text-sm">&larr; Back to ECOs</a>
</div>

<div class="card max-w-2xl">
  <h2 class="text-xl font-bold mb-6">{{if .ECO.ID}}Edit {{.ECO.ID}}{{else}}New ECO{{end}}</h2>
  <form hx-post="/ecos" hx-target="#content" hx-swap="innerHTML" class="space-y-4">
    <div>
      <label class="label">Title</label>
      <input name="title" type="text" class="input" required value="{{.ECO.Title}}" placeholder="ECO title">
    </div>
    <div>
      <label class="label">Description</label>
      <textarea name="description" class="input" rows="4" placeholder="Describe the change...">{{.ECO.Description}}</textarea>
    </div>
    <div class="grid grid-cols-2 gap-4">
      <div>
        <label class="label">Priority</label>
        <select name="priority" class="input">
          <option value="low" {{if eq .ECO.Priority "low"}}selected{{end}}>Low</option>
          <option value="normal" {{if or (eq .ECO.Priority "normal") (eq .ECO.Priority "")}}selected{{end}}>Normal</option>
          <option value="high" {{if eq .ECO.Priority "high"}}selected{{end}}>High</option>
          <option value="critical" {{if eq .ECO.Priority "critical"}}selected{{end}}>Critical</option>
        </select>
      </div>
      <div>
        <label class="label">Status</label>
        <select name="status" class="input">
          <option value="draft" {{if or (eq .ECO.Status "draft") (eq .ECO.Status "")}}selected{{end}}>Draft</option>
          <option value="open" {{if eq .ECO.Status "open"}}selected{{end}}>Open</option>
          <option value="review" {{if eq .ECO.Status "review"}}selected{{end}}>Review</option>
        </select>
      </div>
    </div>
    <div>
      <label class="label">Affected IPNs (comma-separated)</label>
      <input name="affected_ipns" type="text" class="input" value="{{.ECO.AffectedIPNs}}" placeholder="IPN-001, IPN-002">
    </div>
    <div class="flex gap-2">
      <button type="submit" class="btn btn-primary">{{if .ECO.ID}}Update{{else}}Create{{end}} ECO</button>
      <a href="/ecos" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>
{{end}}
