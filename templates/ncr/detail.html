{{define "content"}}
<div class="mb-4">
  <a href="/ncrs" class="text-blue-600 hover:underline text-sm">&larr; Back to NCRs</a>
</div>

<div class="card mb-6">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-bold font-mono">{{.NCR.ID}}</h2>
    <div class="flex gap-2">
      <span class="badge badge-{{.NCR.Severity}}">{{.NCR.Severity}}</span>
      <span class="badge badge-{{.NCR.Status}}">{{.NCR.Status}}</span>
    </div>
  </div>

  <h3 class="text-lg font-medium mb-4">{{.NCR.Title}}</h3>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
    <div>
      <label class="label">Description</label>
      <p class="text-sm text-gray-800 dark:text-gray-200">{{if .NCR.Description}}{{.NCR.Description}}{{else}}&mdash;{{end}}</p>
    </div>
    <div>
      <label class="label">IPN</label>
      <p class="text-sm text-gray-800 dark:text-gray-200 font-mono">{{if .NCR.IPN}}{{.NCR.IPN}}{{else}}&mdash;{{end}}</p>
    </div>
    <div>
      <label class="label">Serial Number</label>
      <p class="text-sm text-gray-800 dark:text-gray-200 font-mono">{{if .NCR.SerialNumber}}{{.NCR.SerialNumber}}{{else}}&mdash;{{end}}</p>
    </div>
    <div>
      <label class="label">Defect Type</label>
      <p class="text-sm text-gray-800 dark:text-gray-200">{{if .NCR.DefectType}}{{.NCR.DefectType}}{{else}}&mdash;{{end}}</p>
    </div>
    <div>
      <label class="label">Created</label>
      <p class="text-sm text-gray-800 dark:text-gray-200">{{formatDate .NCR.CreatedAt}}</p>
    </div>
    {{if .NCR.ResolvedAt}}
    <div>
      <label class="label">Resolved</label>
      <p class="text-sm text-gray-800 dark:text-gray-200">{{formatDate (deref .NCR.ResolvedAt)}}</p>
    </div>
    {{end}}
  </div>

  {{if .NCR.RootCause}}
  <div class="mb-4">
    <label class="label">Root Cause</label>
    <p class="text-sm text-gray-800 dark:text-gray-200">{{.NCR.RootCause}}</p>
  </div>
  {{end}}

  {{if .NCR.CorrectiveAction}}
  <div class="mb-4">
    <label class="label">Corrective Action</label>
    <p class="text-sm text-gray-800 dark:text-gray-200">{{.NCR.CorrectiveAction}}</p>
  </div>
  {{end}}

  <div class="flex gap-2">
    <button class="btn btn-secondary" onclick="editNCR('{{.NCR.ID}}')">Edit NCR</button>
  </div>
</div>
{{end}}