{{define "procurement-detail"}}
<div class="p-6 space-y-4">
  <div class="flex items-center justify-between">
    <h3 class="text-lg font-semibold">PO: {{.PO.ID}}</h3>
    {{badge .PO.Status}}
  </div>
  
  <div class="grid grid-cols-2 gap-4 text-sm">
    <div><span class="label">Vendor</span><p>{{.PO.VendorID}}</p></div>
    <div><span class="label">Expected</span><p>{{if .PO.ExpectedDate}}{{.PO.ExpectedDate}}{{else}}N/A{{end}}</p></div>
    <div><span class="label">Created</span><p>{{formatDate .PO.CreatedAt}}</p></div>
    {{if .PO.ReceivedAt}}<div><span class="label">Received</span><p>{{formatDate (deref .PO.ReceivedAt)}}</p></div>{{end}}
  </div>
  
  {{if .PO.Notes}}
  <div>
    <span class="label">Notes</span>
    <p class="text-sm text-gray-600">{{.PO.Notes}}</p>
  </div>
  {{end}}
  
  <div>
    <h4 class="font-semibold mb-2">Lines</h4>
    {{if eq (len .PO.Lines) 0}}
    <p class="text-gray-400 text-center py-4">No lines</p>
    {{else}}
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead>
          <tr class="border-b border-gray-200 dark:border-gray-700 text-left">
            <th class="px-3 py-2 font-medium text-gray-500">IPN</th>
            <th class="px-3 py-2 font-medium text-gray-500">MPN</th>
            <th class="px-3 py-2 font-medium text-gray-500 text-center">Ordered</th>
            <th class="px-3 py-2 font-medium text-gray-500 text-center">Received</th>
            <th class="px-3 py-2 font-medium text-gray-500 text-right">Price</th>
          </tr>
        </thead>
        <tbody>
          {{range .PO.Lines}}
          <tr class="border-b border-gray-100 dark:border-gray-700">
            <td class="px-3 py-2 font-mono">{{.IPN}}</td>
            <td class="px-3 py-2">{{.MPN}}</td>
            <td class="px-3 py-2 text-center">{{printf "%.0f" .QtyOrdered}}</td>
            <td class="px-3 py-2 text-center">{{printf "%.0f" .QtyReceived}}</td>
            <td class="px-3 py-2 text-right">${{printf "%.2f" .UnitPrice}}</td>
          </tr>
          {{end}}
        </tbody>
      </table>
    </div>
    {{end}}
  </div>
  
  <div class="flex gap-2">
    {{if and (ne .PO.Status "received") (ne .PO.Status "cancelled") (gt (len .PO.Lines) 0)}}
    <button hx-post="/procurement/{{.PO.ID}}/receive" hx-target="#modal-content" hx-swap="innerHTML"
            class="btn btn-success">ðŸ“¥ Receive All</button>
    {{end}}
    <button onclick="document.getElementById('modal').classList.add('hidden')" 
            class="btn btn-secondary">Close</button>
  </div>
</div>
{{end}}

{{define "procurement-receive-success"}}
<div class="p-6 text-center space-y-4">
  <div class="text-green-600">
    <svg class="w-12 h-12 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
    </svg>
    <h3 class="text-lg font-semibold">Items Received!</h3>
    <p class="text-gray-600">All items from PO {{.PO.ID}} have been received into inventory</p>
  </div>
  <button onclick="document.getElementById('modal').classList.add('hidden'); location.reload()" 
          class="btn btn-primary">Close</button>
</div>
{{end}}