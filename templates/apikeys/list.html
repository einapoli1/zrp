{{define "content"}}
<div class="card p-3 mb-4">
  <h3 class="text-sm font-semibold mb-2">Generate New API Key</h3>
  <form hx-post="/apikeys/generate" hx-target="#key-result" class="flex gap-2 items-end">
    <div class="flex-1"><label class="label">Key Name</label><input type="text" name="name" class="input w-full" placeholder="e.g. ci-pipeline" required></div>
    <button type="submit" class="btn btn-primary">Generate</button>
  </form>
  <div id="key-result" class="mt-2"></div>
</div>
<div class="card overflow-x-auto">
  <table class="w-full text-sm">
    <thead><tr class="border-b border-gray-200 dark:border-gray-700 text-left">
      <th class="px-3 py-2 font-medium text-gray-500">Name</th><th class="px-3 py-2 font-medium text-gray-500">Key Prefix</th>
      <th class="px-3 py-2 font-medium text-gray-500">Active</th><th class="px-3 py-2 font-medium text-gray-500">Created</th>
      <th class="px-3 py-2 font-medium text-gray-500"></th>
    </tr></thead>
    <tbody>
      {{range .APIKeyList}}
      <tr class="border-b border-gray-100 dark:border-gray-700">
        <td class="px-3 py-2 font-medium">{{.Name}}</td><td class="px-3 py-2 font-mono text-gray-500">{{.KeyPrefix}}</td>
        <td class="px-3 py-2">{{if eq .Active 1}}<span class="text-green-600">Active</span>{{else}}<span class="text-red-600">Revoked</span>{{end}}</td>
        <td class="px-3 py-2 text-gray-500">{{formatDate .CreatedAt}}</td>
        <td class="px-3 py-2"><button class="btn btn-danger btn-sm" hx-delete="/api/v1/apikeys/{{.ID}}" hx-confirm="Revoke this API key?" hx-target="closest tr" hx-swap="outerHTML">Revoke</button></td>
      </tr>
      {{else}}<tr><td colspan="5" class="px-3 py-8 text-center text-gray-400">No API keys</td></tr>{{end}}
    </tbody>
  </table>
</div>
{{end}}
